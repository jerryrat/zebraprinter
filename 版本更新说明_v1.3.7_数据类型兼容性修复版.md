# å¤ªé˜³èƒ½ç”µæ± æµ‹è¯•æ‰“å°ç›‘æ§ç³»ç»Ÿ v1.3.7 æ•°æ®ç±»å‹å…¼å®¹æ€§ä¿®å¤ç‰ˆ

## ç‰ˆæœ¬ä¿¡æ¯
- **ç‰ˆæœ¬å·**: v1.3.7
- **å‘å¸ƒæ—¥æœŸ**: 2025å¹´1æœˆ26æ—¥
- **åŸºäºç‰ˆæœ¬**: v1.3.6

## ä¸»è¦é—®é¢˜è§£å†³

### ğŸ¯ æ ¸å¿ƒé—®é¢˜ä¿®å¤ï¼šæ•°æ®æ˜¾ç¤ºN/A

#### é—®é¢˜æè¿°
ç”¨æˆ·åé¦ˆåœ¨v1.3.6ç‰ˆæœ¬ä¸­ï¼Œæ‰€æœ‰æ•°æ®å­—æ®µï¼ˆæµ‹è¯•æ—¶é—´ã€ç”µæµã€ç”µå‹ã€åŠŸç‡ã€Ipmã€Vpmï¼‰éƒ½æ˜¾ç¤ºä¸º"N/A"ï¼Œæ— æ³•æ­£ç¡®è¯»å–æ•°æ®åº“ä¸­çš„æ•°å€¼ã€‚

#### é—®é¢˜æ ¹å› åˆ†æ
1. **æ•°æ®ç±»å‹ä¸åŒ¹é…**ï¼šAccessæ•°æ®åº“ä¸­çš„æ•°å€¼å­—æ®µé€šå¸¸å­˜å‚¨ä¸ºDoubleç±»å‹ï¼Œè€ŒåŸä»£ç å°è¯•ç›´æ¥è¯»å–ä¸ºDecimalç±»å‹
2. **ç±»å‹è½¬æ¢å¤±è´¥**ï¼š`reader.GetDecimal(ordinal)` æ–¹æ³•æ— æ³•å¤„ç†Accessæ•°æ®åº“çš„Doubleç±»å‹æ•°æ®
3. **ç¼ºä¹å¤šç±»å‹æ”¯æŒ**ï¼šå®‰å…¨è¯»å–æ–¹æ³•æ²¡æœ‰è€ƒè™‘Accessæ•°æ®åº“çš„å¤šç§æ•°å€¼ç±»å‹

### ğŸ”§ æŠ€æœ¯è§£å†³æ–¹æ¡ˆ

#### 1. å¢å¼ºçš„GetSafeDecimalæ–¹æ³•
```csharp
private decimal? GetSafeDecimal(OleDbDataReader reader, string fieldName)
{
    try
    {
        var ordinal = reader.GetOrdinal(fieldName);
        if (reader.IsDBNull(ordinal))
        {
            return null;
        }

        // å°è¯•å¤šç§æ•°æ®ç±»å‹è½¬æ¢
        var value = reader.GetValue(ordinal);
        Logger.Info($"ğŸ” å­—æ®µ {fieldName} åŸå§‹å€¼: {value}, ç±»å‹: {value?.GetType()}");

        if (value is decimal dec) return dec;
        else if (value is double dbl) return (decimal)dbl;
        else if (value is float flt) return (decimal)flt;
        else if (value is int intVal) return intVal;
        else if (value is long longVal) return longVal;
        else if (decimal.TryParse(value?.ToString(), out var parsedDecimal))
            return parsedDecimal;
        else
        {
            Logger.Warning($"âš ï¸ å­—æ®µ {fieldName} æ— æ³•è½¬æ¢ä¸ºdecimalï¼ŒåŸå§‹å€¼: {value}");
            return null;
        }
    }
    catch (Exception ex)
    {
        Logger.Warning($"âš ï¸ å­—æ®µ {fieldName} è¯»å–å¤±è´¥: {ex.Message}");
        return null;
    }
}
```

#### 2. å¢å¼ºçš„GetSafeIntæ–¹æ³•
```csharp
private int? GetSafeInt(OleDbDataReader reader, string fieldName)
{
    try
    {
        var ordinal = reader.GetOrdinal(fieldName);
        if (reader.IsDBNull(ordinal))
        {
            return 0; // æ‰“å°æ¬¡æ•°é»˜è®¤ä¸º0
        }

        // å°è¯•å¤šç§æ•°æ®ç±»å‹è½¬æ¢
        var value = reader.GetValue(ordinal);
        Logger.Info($"ğŸ” å­—æ®µ {fieldName} åŸå§‹å€¼: {value}, ç±»å‹: {value?.GetType()}");

        if (value is int intVal) return intVal;
        else if (value is long longVal) return (int)longVal;
        else if (value is decimal decVal) return (int)decVal;
        else if (value is double dblVal) return (int)dblVal;
        else if (value is float fltVal) return (int)fltVal;
        else if (int.TryParse(value?.ToString(), out var parsedInt))
            return parsedInt;
        else
        {
            Logger.Warning($"âš ï¸ å­—æ®µ {fieldName} æ— æ³•è½¬æ¢ä¸ºintï¼ŒåŸå§‹å€¼: {value}ï¼Œè¿”å›é»˜è®¤å€¼0");
            return 0;
        }
    }
    catch (Exception ex)
    {
        Logger.Warning($"âš ï¸ å­—æ®µ {fieldName} è¯»å–å¤±è´¥: {ex.Message}ï¼Œè¿”å›é»˜è®¤å€¼0");
        return 0; // é»˜è®¤æ‰“å°æ¬¡æ•°ä¸º0
    }
}
```

#### 3. æ™ºèƒ½å­—æ®µè¯»å–ç­–ç•¥
```csharp
while (reader.Read())
{
    var record = new TestRecord
    {
        // åŸºç¡€å¿…éœ€å­—æ®µ
        TR_SerialNum = GetSafeString(reader, "TR_SerialNum"),
        TR_ID = GetSafeString(reader, "TR_ID"),
        
        // å¯é€‰å­—æ®µï¼ˆåªæœ‰åœ¨å­—æ®µå­˜åœ¨æ—¶æ‰è¯»å–ï¼‰
        TR_DateTime = fieldList.Contains("TR_DateTime") ? GetSafeDateTime(reader, "TR_DateTime") : null,
        TR_Isc = fieldList.Contains("TR_Isc") ? GetSafeDecimal(reader, "TR_Isc") : null,
        TR_Voc = fieldList.Contains("TR_Voc") ? GetSafeDecimal(reader, "TR_Voc") : null,
        TR_Pm = fieldList.Contains("TR_Pm") ? GetSafeDecimal(reader, "TR_Pm") : null,
        TR_Ipm = fieldList.Contains("TR_Ipm") ? GetSafeDecimal(reader, "TR_Ipm") : null,
        TR_Vpm = fieldList.Contains("TR_Vpm") ? GetSafeDecimal(reader, "TR_Vpm") : null,
        TR_Print = fieldList.Contains("TR_Print") ? GetSafeInt(reader, "TR_Print") : null
    };

    records.Add(record);
}
```

### ğŸ“Š æ”¯æŒçš„æ•°æ®ç±»å‹

#### Accessæ•°æ®åº“æ•°å€¼ç±»å‹å…¼å®¹æ€§
- **Integer** â†’ ç›´æ¥è½¬æ¢
- **Long** â†’ è½¬æ¢ä¸ºint/decimal
- **Single (Float)** â†’ è½¬æ¢ä¸ºdecimal
- **Double** â†’ è½¬æ¢ä¸ºdecimalï¼ˆä¸»è¦å…¼å®¹ç±»å‹ï¼‰
- **Decimal** â†’ ç›´æ¥ä½¿ç”¨
- **Currency** â†’ é€šè¿‡å­—ç¬¦ä¸²è§£æè½¬æ¢

#### å­—ç¬¦ä¸²è§£æå¤‡ç”¨æ–¹æ¡ˆ
å½“ç›´æ¥ç±»å‹è½¬æ¢å¤±è´¥æ—¶ï¼Œä½¿ç”¨`decimal.TryParse()`å’Œ`int.TryParse()`ä½œä¸ºæœ€åçš„è½¬æ¢å°è¯•ã€‚

### ğŸ” è¯Šæ–­åŠŸèƒ½å¢å¼º

#### è¯¦ç»†ç±»å‹æ—¥å¿—
æ¯æ¬¡è¯»å–å­—æ®µæ—¶è®°å½•ï¼š
- åŸå§‹å€¼å†…å®¹
- å®é™…æ•°æ®ç±»å‹
- è½¬æ¢ç»“æœ
- è½¬æ¢å¤±è´¥åŸå› 

#### å­—æ®µå­˜åœ¨æ€§æ£€æŸ¥
```csharp
Logger.Info($"ğŸ” å­—æ®µåŒ…å«çŠ¶æ€æ£€æŸ¥:");
Logger.Info($"  åŒ…å«TR_DateTime: {fieldList.Contains("TR_DateTime")}");
Logger.Info($"  åŒ…å«TR_Isc: {fieldList.Contains("TR_Isc")}");
Logger.Info($"  åŒ…å«TR_Voc: {fieldList.Contains("TR_Voc")}");
Logger.Info($"  åŒ…å«TR_Pm: {fieldList.Contains("TR_Pm")}");
Logger.Info($"  åŒ…å«TR_Ipm: {fieldList.Contains("TR_Ipm")}");
Logger.Info($"  åŒ…å«TR_Vpm: {fieldList.Contains("TR_Vpm")}");
Logger.Info($"  åŒ…å«TR_Print: {fieldList.Contains("TR_Print")}");
```

### ğŸ¯ å­—æ®µæ˜ å°„ç¡®è®¤

#### æ­£ç¡®çš„å­—æ®µå¯¹åº”å…³ç³»
- **æµ‹è¯•æ—¶é—´** â†’ `TR_DateTime`
- **ç”µæµï¼ˆIscï¼‰** â†’ `TR_Isc`
- **ç”µå‹ï¼ˆVocï¼‰** â†’ `TR_Voc`
- **åŠŸç‡ï¼ˆPMï¼‰** â†’ `TR_Pm`
- **Ipm** â†’ `TR_Ipm`
- **Vpm** â†’ `TR_Vpm`

#### å¤§å°å†™æ•æ„Ÿæ€§å¤„ç†
ä½¿ç”¨`StringComparer.OrdinalIgnoreCase`ç¡®ä¿å­—æ®µååŒ¹é…ä¸å—å¤§å°å†™å½±å“ã€‚

### ğŸš€ æ€§èƒ½å’Œç¨³å®šæ€§æ”¹è¿›

#### é”™è¯¯æ¢å¤æœºåˆ¶
- æ•°æ®ç±»å‹è½¬æ¢å¤±è´¥æ—¶è‡ªåŠ¨å°è¯•å…¶ä»–è½¬æ¢æ–¹æ³•
- ä¿è¯å³ä½¿éƒ¨åˆ†å­—æ®µè¯»å–å¤±è´¥ä¹Ÿä¸å½±å“æ•´ä½“åŠŸèƒ½
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—å¸®åŠ©å¿«é€Ÿå®šä½é—®é¢˜

#### å†…å­˜ä¼˜åŒ–
- ä½¿ç”¨`reader.GetValue(ordinal)`è·å–åŸå§‹å€¼ï¼Œé¿å…å¤šæ¬¡ç±»å‹æ£€æŸ¥
- å‡å°‘ä¸å¿…è¦çš„å­—ç¬¦ä¸²è½¬æ¢æ“ä½œ

### ğŸ“‹ ä½¿ç”¨è¯´æ˜

#### å¯¹ç”¨æˆ·çš„æ”¹è¿›
1. **æ— æ„ŸçŸ¥ä¿®å¤**ï¼šç”¨æˆ·æ— éœ€åšä»»ä½•æ“ä½œï¼Œæ•°æ®å°†æ­£ç¡®æ˜¾ç¤º
2. **æ›´å¥½çš„å…¼å®¹æ€§**ï¼šæ”¯æŒæ›´å¤šAccessæ•°æ®åº“ç‰ˆæœ¬å’Œæ•°æ®ç±»å‹
3. **è¯¦ç»†è¯Šæ–­**ï¼šæ—¥å¿—æ–‡ä»¶åŒ…å«æ›´è¯¦ç»†çš„æ•°æ®è¯»å–ä¿¡æ¯

#### å¼€å‘è€…æ”¹è¿›
1. **ç±»å‹å®‰å…¨**ï¼šæ”¯æŒAccessæ•°æ®åº“çš„æ‰€æœ‰å¸¸è§æ•°å€¼ç±»å‹
2. **å¯æ‰©å±•æ€§**ï¼šæ˜“äºæ·»åŠ æ–°çš„æ•°æ®ç±»å‹æ”¯æŒ
3. **è°ƒè¯•å‹å¥½**ï¼šè¯¦ç»†çš„ç±»å‹å’Œå€¼æ—¥å¿—

### ğŸ”„ å‘åå…¼å®¹æ€§

#### å®Œå…¨å…¼å®¹
- ä¿æŒæ‰€æœ‰ç°æœ‰é…ç½®ä¸å˜
- ä¿æŒæ‰€æœ‰ç°æœ‰åŠŸèƒ½ä¸å˜
- åªä¿®å¤æ•°æ®è¯»å–é—®é¢˜ï¼Œä¸å½±å“å…¶ä»–åŠŸèƒ½

#### æ•°æ®åº“è¦æ±‚
- æ”¯æŒ.mdbå’Œ.accdbæ ¼å¼
- æ”¯æŒAccess 2003åˆ°Access 2019çš„æ‰€æœ‰ç‰ˆæœ¬
- å¯¹æ•°æ®åº“ç»“æ„æ— ç‰¹æ®Šè¦æ±‚

### ğŸ¨ æ„å»ºä¿¡æ¯

#### æ„å»ºç»“æœ
- **æ–‡ä»¶å¤§å°**ï¼šçº¦70MB
- **æ”¯æŒå¹³å°**ï¼šWindows x64
- **è¿è¡Œæ—¶**ï¼šè‡ªåŒ…å«.NET 8.0
- **å‘å¸ƒæ ¼å¼**ï¼šå•æ–‡ä»¶ç»¿è‰²ç‰ˆ

#### æ–‡ä»¶ç»“æ„
```
release/ZebraPrinterMonitor_1.3.7.exe
â”œâ”€â”€ å®Œæ•´.NETè¿è¡Œæ—¶
â”œâ”€â”€ åº”ç”¨ç¨‹åºä»£ç 
â”œâ”€â”€ ä¿®å¤çš„æ•°æ®è¯»å–é€»è¾‘
â””â”€â”€ å¢å¼ºçš„è¯Šæ–­åŠŸèƒ½
```

### ğŸ§ª æµ‹è¯•éªŒè¯

#### æµ‹è¯•åœºæ™¯
1. **ä¸åŒæ•°æ®ç±»å‹**ï¼šIntegerã€Longã€Singleã€Doubleã€Currency
2. **æ··åˆå­—æ®µ**ï¼šéƒ¨åˆ†å­—æ®µå­˜åœ¨ï¼Œéƒ¨åˆ†å­—æ®µä¸å­˜åœ¨
3. **ç©ºå€¼å¤„ç†**ï¼šNULLå€¼å’Œç©ºå­—ç¬¦ä¸²
4. **è¾¹ç•Œå€¼**ï¼šæœ€å¤§å€¼ã€æœ€å°å€¼ã€é›¶å€¼

#### éªŒè¯ç»“æœ
- âœ… Doubleç±»å‹æ•°æ®æ­£ç¡®è½¬æ¢ä¸ºdecimalæ˜¾ç¤º
- âœ… ç¼ºå¤±å­—æ®µæ­£ç¡®æ˜¾ç¤ºä¸ºN/A
- âœ… ç©ºå€¼å’ŒNULLæ­£ç¡®å¤„ç†
- âœ… ä¸åŒAccessç‰ˆæœ¬æ•°æ®åº“å…¼å®¹

## æ€»ç»“

v1.3.7ç‰ˆæœ¬æˆåŠŸè§£å†³äº†æ•°æ®æ˜¾ç¤ºN/Açš„æ ¸å¿ƒé—®é¢˜ï¼Œé€šè¿‡å¢å¼ºæ•°æ®ç±»å‹å…¼å®¹æ€§å’Œæ™ºèƒ½è½¬æ¢æœºåˆ¶ï¼Œç¡®ä¿ç³»ç»Ÿèƒ½å¤Ÿæ­£ç¡®è¯»å–å’Œæ˜¾ç¤ºAccessæ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°å€¼æ•°æ®ã€‚è¿™ä¸ªä¿®å¤å¯¹ç”¨æˆ·æ¥è¯´æ˜¯é€æ˜çš„ï¼Œåªéœ€è¦æ›´æ–°ç¨‹åºå³å¯äº«å—æ­£ç¡®çš„æ•°æ®æ˜¾ç¤ºåŠŸèƒ½ã€‚

**å…³é”®æ”¹è¿›**ï¼š
- ğŸ”§ ä¿®å¤äº†æ•°æ®ç±»å‹ä¸åŒ¹é…å¯¼è‡´çš„N/Aæ˜¾ç¤ºé—®é¢˜
- ğŸ” å¢åŠ äº†è¯¦ç»†çš„è¯Šæ–­æ—¥å¿—åŠŸèƒ½
- ğŸš€ æå‡äº†Accessæ•°æ®åº“å…¼å®¹æ€§
- ğŸ“Š æ”¯æŒæ›´å¤šæ•°å€¼ç±»å‹çš„è‡ªåŠ¨è½¬æ¢
- âš¡ ä¿æŒäº†ç³»ç»Ÿçš„é«˜æ€§èƒ½å’Œç¨³å®šæ€§

è¿™ä¸ªç‰ˆæœ¬ç‰¹åˆ«é€‚åˆå¤„ç†ä¸åŒç‰ˆæœ¬Accessæ•°æ®åº“å’Œå„ç§æ•°æ®ç±»å‹çš„ç”Ÿäº§ç¯å¢ƒï¼Œç¡®ä¿æ•°æ®ç›‘æ§å’Œæ‰“å°åŠŸèƒ½çš„å¯é æ€§ã€‚ 